# 🎵 自动歌词生成系统使用指南

## ✨ 功能概述

我已经为你创建了一个完整的自动歌词生成系统，可以在每次添加新音乐时自动：
- 🏗️ 创建完整的文件夹结构
- 📝 自动搜索并生成歌词文件
- 🖼️ 生成默认封面图片
- 📊 创建元数据文件
- ⏱️ 生成时间戳模板
- 🔄 自动更新音乐列表

---

## 🚀 快速开始

### 1. 为新添加的音乐自动生成歌词

**方法一：处理单个文件**
```bash
# 将新的音乐文件放到 public/music/music list/ 目录下
# 然后运行：
node add-music.js "新歌曲.mp3"
```

**方法二：处理所有新文件**
```bash
# 将多个音乐文件放到 public/music/music list/ 目录下
# 然后运行：
node add-music.js
```

### 2. 使用原有的音乐管理工具

```bash
# 生成所有音乐文件的元数据
node src/generateMusicMetadata.js

# 为所有音乐生成歌词
node src/autoLyricsGenerator.js
```

---

## 📁 自动生成的文件夹结构

每首音乐会自动创建以下结构：

```
public/music/music list/
└── 歌曲名/
    ├── 歌曲名.mp3          # 音频文件
    ├── cover.svg           # 封面图片（SVG格式）
    ├── lyrics.lrc          # 歌词文件（LRC格式）
    ├── metadata.json       # 元数据文件
    └── timestamps.json     # 时间戳文件
```

---

## 📝 歌词文件格式

### LRC格式示例
```lrc
[ti:歌曲标题]
[ar:艺术家]
[al:专辑]
[by:自动生成]
[00:00.00]歌曲标题 - 艺术家
[00:05.00]
[00:10.00]第一句歌词
[00:15.00]第二句歌词
[00:20.00]第三句歌词
```

### 时间戳格式
- `[分:秒.百分秒]` - 精确到百分之一秒
- 例如：`[01:23.45]` 表示 1分23秒45

---

## 🎯 使用场景

### 场景1：添加单首新歌
```bash
# 1. 将 "新歌.mp3" 放到 public/music/music list/ 目录
# 2. 运行命令：
node add-music.js "新歌.mp3"

# 系统会自动：
# - 创建 "新歌" 文件夹
# - 移动音频文件到文件夹内
# - 搜索歌词并生成 lyrics.lrc
# - 创建封面、元数据、时间戳文件
# - 更新 musicList.json
```

### 场景2：批量添加多首歌
```bash
# 1. 将多个音乐文件放到 public/music/music list/ 目录
# 2. 运行命令：
node add-music.js

# 系统会自动处理所有新的音频文件
```

### 场景3：只生成歌词（已有文件夹）
```bash
# 为指定文件夹生成歌词：
node src/autoLyricsGenerator.js "文件夹名"

# 为所有文件夹生成歌词：
node src/autoLyricsGenerator.js
```

---

## 🔧 歌词搜索功能

### 自动搜索
系统会尝试从在线歌词库搜索歌词：
1. 使用歌曲标题和艺术家信息
2. 自动转换为LRC格式
3. 如果搜索失败，生成模板文件

### 手动编辑
生成的歌词文件可以手动编辑：
```lrc
[ti:我的歌曲]
[ar:我的名字]
[al:我的专辑]
[by:手动编辑]
[00:00.00]我的歌曲 - 我的名字
[00:05.00]
[00:10.00]这是第一句歌词
[00:15.00]这是第二句歌词
[00:20.00]这是第三句歌词
```

---

## 🎨 封面图片

### 自动生成
- 系统会创建SVG格式的封面
- 包含歌曲标题和音乐图标
- 使用渐变色背景

### 自定义封面
你可以替换自动生成的封面：
1. 将图片文件（JPG/PNG）重命名为 `cover.jpg`
2. 放到对应的歌曲文件夹中
3. 运行更新命令

---

## 📊 元数据管理

### 自动生成的元数据
```json
{
  "title": "歌曲标题",
  "artist": "艺术家",
  "album": "未知专辑",
  "year": "2024",
  "genre": "未分类",
  "duration": "未知",
  "durationSeconds": 0,
  "language": "中文",
  "tags": [],
  "description": "自动生成的音乐文件: 歌曲标题",
  "created": "2024-01-01T00:00:00.000Z",
  "lastModified": "2024-01-01T00:00:00.000Z"
}
```

### 手动编辑元数据
编辑 `metadata.json` 文件可以完善歌曲信息：
- 修改标题、艺术家、专辑
- 添加标签、描述
- 设置正确的年份、流派

---

## ⏱️ 时间戳管理

### 自动生成的时间戳结构
```json
{
  "structure": {
    "intro": { "start": 0, "end": 15, "label": "前奏" },
    "verse1": { "start": 15, "end": 45, "label": "第一段" },
    "chorus": { "start": 45, "end": 75, "label": "副歌" },
    "verse2": { "start": 75, "end": 105, "label": "第二段" },
    "chorus2": { "start": 105, "end": 135, "label": "副歌" },
    "outro": { "start": 135, "end": 150, "label": "尾奏" }
  },
  "highlights": [],
  "notes": "请根据实际歌曲调整时间戳"
}
```

### 自定义时间戳
根据实际歌曲结构调整时间戳：
- 修改各段落的时间范围
- 添加高光时刻
- 添加备注说明

---

## 🔄 工作流程

### 添加新音乐的标准流程

1. **准备音乐文件**
   ```
   将音频文件放到: public/music/music list/
   ```

2. **运行自动处理**
   ```bash
   node add-music.js "歌曲名.mp3"
   ```

3. **检查生成的文件**
   - `lyrics.lrc` - 检查歌词内容
   - `metadata.json` - 完善歌曲信息
   - `cover.svg` - 替换为自定义封面（可选）

4. **刷新浏览器**
   - 查看音乐播放器中的新歌曲
   - 测试歌词显示功能

---

## 🛠️ 高级功能

### 批量处理
```bash
# 处理所有新的音乐文件
node add-music.js

# 只生成歌词（不创建文件夹结构）
node src/autoLyricsGenerator.js

# 只生成元数据
node src/generateMusicMetadata.js
```

### 自定义配置
编辑 `src/autoLyricsGenerator.js` 可以：
- 修改歌词搜索API
- 调整LRC格式模板
- 自定义默认歌词内容

---

## 📋 文件说明

| 文件 | 用途 | 说明 |
|------|------|------|
| `add-music.js` | 主入口脚本 | 添加新音乐的核心工具 |
| `src/smartMusicManager.js` | 智能管理器 | 完整的音乐文件管理 |
| `src/autoLyricsGenerator.js` | 歌词生成器 | 自动搜索和生成歌词 |
| `src/generateMusicMetadata.js` | 元数据生成器 | 生成音乐元数据 |

---

## ⚠️ 注意事项

1. **文件命名**：
   - 音频文件名建议包含艺术家和歌曲名
   - 格式：`艺术家 - 歌曲名.mp3`
   - 避免特殊字符

2. **歌词质量**：
   - 自动搜索的歌词可能不准确
   - 建议手动检查和编辑
   - 确保时间戳与音频同步

3. **网络连接**：
   - 歌词搜索需要网络连接
   - 搜索失败时会生成模板文件

4. **文件权限**：
   - 确保脚本有读写权限
   - 检查文件夹访问权限

---

## 🎉 使用示例

### 示例1：添加一首新歌
```bash
# 1. 将 "周杰伦 - 稻香.mp3" 放到 music list 目录
# 2. 运行：
node add-music.js "周杰伦 - 稻香.mp3"

# 输出：
# ✅ 创建文件夹: 周杰伦 - 稻香
# ✅ 移动音频文件: 周杰伦 - 稻香.mp3
# ✅ 创建封面文件: cover.svg
# ✅ 创建元数据文件: metadata.json
# 🔍 为 周杰伦 - 稻香 生成歌词...
# ✅ 周杰伦 - 稻香: 找到歌词，转换为LRC格式
# ✅ 周杰伦 - 稻香: 歌词文件已生成
# ✅ 创建时间戳文件: timestamps.json
# ✅ 周杰伦 - 稻香: 添加到音乐列表
# ✅ 成功更新 musicList.json (1 首音乐)
```

### 示例2：批量处理
```bash
# 1. 将多个音乐文件放到 music list 目录
# 2. 运行：
node add-music.js

# 系统会自动处理所有新的音频文件
```

---

## 🚀 立即开始

1. **准备音乐文件**：将音频文件放到 `public/music/music list/` 目录
2. **运行脚本**：`node add-music.js`
3. **检查结果**：查看生成的文件夹和文件
4. **编辑完善**：根据需要编辑歌词和元数据
5. **刷新页面**：在浏览器中查看效果

**现在每次添加新音乐都会自动生成完整的歌词和元数据！** 🎵✨

---

## 📞 技术支持

如有问题：
1. 检查控制台错误信息
2. 确认文件路径正确
3. 检查网络连接（歌词搜索）
4. 查看生成的文件内容

**享受自动化音乐管理的便利！** 🎶
