# 蓝图式连接系统使用指南

## 📖 概述

可视化工具包现在支持蓝图式连接系统，允许工具之间通过连接线传递数据，实现复杂的数据流操作。

## 🎯 核心功能

### 1. 工具端口
每个工具都有输入/输出端口：
- **变量工具**：输出端口（右侧蓝色圆点）
- **列表工具**：输入端口（左侧绿色圆点，用于接收操作输出）
- **循环工具**：输入端口（左侧蓝色圆点，用于接收变量）
- **操作节点**：输入端口（左侧蓝色圆点）和输出端口（右侧绿色圆点）

### 2. 操作节点
列表工具右上角有操作按钮（⚙️），点击后可以选择操作：
- **追加 (append)**：将变量值追加到列表末尾
- **插入 (insert)**：在指定位置插入变量值
- **删除 (remove)**：从列表中删除匹配的变量值
- **弹出 (pop)**：移除列表最后一个元素

选择操作后，会自动创建操作节点并连接到列表。

### 3. 连接方式

#### 连接变量到操作节点
1. 点击变量的输出端口（右侧蓝色圆点）
2. 点击操作节点的输入端口（左侧蓝色圆点）
3. 连接线会自动创建

#### 连接多个变量到操作节点
- 可以连接多个变量到同一个操作节点
- 连接顺序决定执行顺序（显示在连接线上）
- 例如：变量1 → 操作节点（顺序1），变量2 → 操作节点（顺序2）

#### 操作节点自动连接到列表
- 创建操作节点时，会自动连接到对应的列表
- 操作节点的输出端口连接到列表的输入端口

## 🔗 连接流程示例

### 示例：列表追加操作

```
[变量1] ──┐
          ├─→ [追加操作] ──→ [列表]
[变量2] ──┘
```

**步骤：**
1. 添加列表工具
2. 点击列表右上角的操作按钮，选择"追加"
3. 自动创建"追加"操作节点，并连接到列表
4. 添加变量1，点击其输出端口，再点击操作节点的输入端口
5. 添加变量2，点击其输出端口，再点击操作节点的输入端口
6. 运行可视化，变量1和变量2会按顺序追加到列表中

### 连接顺序的重要性

连接顺序决定了变量在操作中的执行顺序：
- 第一个连接的变量（顺序1）会先执行
- 第二个连接的变量（顺序2）会接着执行
- 以此类推

连接线上会显示顺序编号（1, 2, 3...）

## 🎮 操作说明

### 创建连接
1. **点击输出端口**：开始连接（端口会高亮）
2. **点击输入端口**：完成连接（创建连接线）
3. **点击空白处**：取消连接

### 删除连接
- 点击连接线可以删除（功能待完善）
- 删除工具时，相关连接会自动删除

### 移动工具
- 拖拽工具移动时，连接线会自动跟随
- 连接线使用贝塞尔曲线，自动调整路径

## 📊 数据流执行

### 执行逻辑
1. **变量 → 操作节点**：变量值按连接顺序传递给操作节点
2. **操作节点 → 列表**：操作节点执行操作，结果传递给列表
3. **循环控制**：如果有循环工具，每个循环步骤都会执行一次操作

### 操作类型详解

#### Append（追加）
- 将所有连接的变量值按顺序追加到列表末尾
- 例如：变量1=5, 变量2=10 → 列表变为 [原有元素, 5, 10]

#### Insert（插入）
- 第一个变量作为索引，其余变量作为插入值
- 例如：变量1=1（索引）, 变量2=5 → 在索引1位置插入5

#### Remove（删除）
- 从列表中删除所有匹配的变量值
- 例如：变量1=5 → 删除列表中所有值为5的元素

#### Pop（弹出）
- 移除列表最后一个元素（不需要变量输入）

## 💡 使用技巧

1. **规划布局**：将相关工具放在一起，连接线更清晰
2. **顺序很重要**：注意连接顺序，它决定了执行顺序
3. **测试连接**：运行可视化前，检查连接是否正确
4. **清理连接**：删除不需要的工具时，相关连接会自动清理

## 🔮 未来扩展

- 支持更多操作类型
- 支持连接线删除功能
- 支持连接验证（类型检查）
- 支持连接分组和标签
- 支持数据流动画效果

